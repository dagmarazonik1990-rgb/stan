<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>STAN ‚Ä¢ ME</title>

  <!-- osobny manifest dla Ciebie -->
  <link rel="manifest" href="manifest-me.json" />

  <meta name="theme-color" content="#0B0F1A" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <style>
    :root{
      --bg:#070A12;
      --panel: rgba(18, 22, 40, .52);
      --panel2: rgba(18, 22, 40, .36);
      --stroke: rgba(255,255,255,.10);
      --stroke2: rgba(255,255,255,.14);
      --text:#E9ECF6;
      --muted: rgba(233,236,246,.66);

      --violet:#8C5CFF;
      --violet2:#B66BFF;
      --cyan:#58C7FF;

      --radius: 22px;
      --shadow: 0 18px 55px rgba(0,0,0,.55);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--text);
      background:
        radial-gradient(1100px 700px at 20% -10%, rgba(140,92,255,.22), transparent 55%),
        radial-gradient(900px 600px at 85% 15%, rgba(88,199,255,.12), transparent 55%),
        radial-gradient(900px 900px at 50% 110%, rgba(182,107,255,.10), transparent 60%),
        linear-gradient(180deg, #050711, #070A12 35%, #060915);
      padding: max(18px, env(safe-area-inset-top)) 16px max(18px, env(safe-area-inset-bottom));
    }

    .wrap{
      max-width: 720px;
      margin: 0 auto;
    }

    .brand{
      margin-top: 6px;
      margin-bottom: 12px;
    }
    .brand h1{
      margin:0;
      font-size: 56px;
      letter-spacing: .8px;
      line-height: 1.02;
      font-weight: 800;
    }
    .brand .sub{
      margin-top: 8px;
      color: var(--muted);
      font-size: 18px;
      letter-spacing:.2px;
    }

    .card{
      background: var(--panel);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
    }

    .avatarCard{
      position: relative;
      overflow: hidden;
      padding: 18px 16px 12px;
      margin-top: 18px;
    }
    .avatarHeader{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom: 14px;
    }
    .avatarHeader .title{
      font-weight:700;
      color: rgba(233,236,246,.82);
      letter-spacing:.2px;
    }
    .pill{
      font-size: 12px;
      color: rgba(233,236,246,.78);
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.20);
      border: 1px solid rgba(255,255,255,.10);
      white-space: nowrap;
    }

    .avatarStage{
      position: relative;
      border-radius: 18px;
      border: 1px solid var(--stroke2);
      background:
        radial-gradient(420px 280px at 50% 30%, rgba(182,107,255,.20), transparent 65%),
        radial-gradient(420px 320px at 50% 70%, rgba(88,199,255,.12), transparent 70%),
        rgba(0,0,0,.16);
      overflow:hidden;
      height: 320px;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);
      user-select:none;
      -webkit-user-select:none;
    }

    /* premium glow layer */
    .avatarStage::before{
      content:"";
      position:absolute; inset:-80px;
      background:
        radial-gradient(400px 260px at 50% 35%, rgba(140,92,255,.38), transparent 60%),
        radial-gradient(320px 220px at 35% 65%, rgba(88,199,255,.22), transparent 65%),
        radial-gradient(340px 240px at 70% 70%, rgba(182,107,255,.18), transparent 70%);
      filter: blur(18px);
      opacity:.8;
      pointer-events:none;
      animation: drift 8s ease-in-out infinite;
    }
    @keyframes drift{
      0%,100%{transform: translate3d(0,0,0) scale(1)}
      50%{transform: translate3d(10px,-8px,0) scale(1.02)}
    }

    .semiSvg{
      position: relative;
      width: 82%;
      max-width: 420px;
      height: auto;
      transform: translateZ(0);
      filter: drop-shadow(0 18px 45px rgba(0,0,0,.55));
      animation: floaty 4.8s ease-in-out infinite;
    }
    @keyframes floaty{
      0%,100%{transform: translateY(0)}
      50%{transform: translateY(-6px)}
    }

    .inputCard{
      margin-top: 16px;
      padding: 14px;
    }
    textarea{
      width:100%;
      min-height: 130px;
      resize: vertical;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      color: var(--text);
      padding: 14px 14px;
      outline: none;
      font-size: 16px;
      line-height: 1.35;
    }
    textarea::placeholder{color: rgba(233,236,246,.45)}

    .actions{
      display:flex;
      gap:10px;
      margin-top: 12px;
      flex-wrap: wrap;
    }
    .btn{
      appearance:none;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      color: var(--text);
      padding: 12px 14px;
      border-radius: 16px;
      font-weight: 700;
      letter-spacing: .2px;
      cursor: pointer;
    }
    .btnPrimary{
      flex: 1;
      min-width: 160px;
      background: linear-gradient(90deg, rgba(140,92,255,.95), rgba(182,107,255,.92));
      border-color: rgba(255,255,255,.14);
      box-shadow: 0 16px 40px rgba(140,92,255,.25);
    }
    .btnSmall{
      font-weight: 700;
      padding: 12px 12px;
    }

    .statusRow{
      display:flex;
      gap:10px;
      flex-wrap: wrap;
      margin-top: 12px;
      color: var(--muted);
      font-size: 13px;
    }

    .resultGrid{
      margin-top: 14px;
      display:grid;
      gap: 12px;
    }

    .resultCard{
      padding: 16px;
      background: var(--panel2);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
    }
    .resultTitle{
      font-size: 28px;
      font-weight: 800;
      margin: 0 0 8px 0;
      letter-spacing: .2px;
    }
    .resultText{
      margin:0;
      color: rgba(233,236,246,.78);
      font-size: 16px;
      line-height: 1.45;
      white-space: pre-wrap;
    }

    .hint{
      margin-top: 10px;
      color: rgba(233,236,246,.55);
      font-size: 12px;
      line-height: 1.35;
    }

    .danger{
      color: rgba(255,140,140,.9);
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="brand">
      <h1>STAN</h1>
      <div class="sub">Agent decyzyjny AI ‚Ä¢ wersja ME (semi-human)</div>
    </div>

    <div class="card avatarCard">
      <div class="avatarHeader">
        <div class="title">STAN avatar (premium)</div>
        <div class="pill">Dla Ciebie: Semi-human</div>
      </div>

      <div class="avatarStage" id="avatarStage" title="To jest Tw√≥j premium avatar.">
        <!-- Premium semi-human SVG (bez plik√≥w w repo) -->
        <svg class="semiSvg" viewBox="0 0 700 700" xmlns="http://www.w3.org/2000/svg" aria-label="STAN Semi-human">
          <defs>
            <radialGradient id="bgGlow" cx="50%" cy="35%" r="70%">
              <stop offset="0%" stop-color="#B66BFF" stop-opacity=".55"/>
              <stop offset="45%" stop-color="#8C5CFF" stop-opacity=".22"/>
              <stop offset="100%" stop-color="#000" stop-opacity="0"/>
            </radialGradient>

            <linearGradient id="shell" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#14172A"/>
              <stop offset="45%" stop-color="#0C1020"/>
              <stop offset="100%" stop-color="#070A14"/>
            </linearGradient>

            <linearGradient id="rim" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0%" stop-color="#B66BFF" stop-opacity=".95"/>
              <stop offset="60%" stop-color="#58C7FF" stop-opacity=".75"/>
              <stop offset="100%" stop-color="#8C5CFF" stop-opacity=".85"/>
            </linearGradient>

            <filter id="soft" x="-30%" y="-30%" width="160%" height="160%">
              <feGaussianBlur in="SourceGraphic" stdDeviation="2.4" result="blur"/>
              <feColorMatrix in="blur" type="matrix"
                values="1 0 0 0 0
                        0 1 0 0 0
                        0 0 1 0 0
                        0 0 0 0.65 0" />
            </filter>

            <filter id="neon" x="-40%" y="-40%" width="180%" height="180%">
              <feGaussianBlur stdDeviation="6" result="b"/>
              <feColorMatrix in="b" type="matrix"
                values="1 0 0 0 0
                        0 1 0 0 0
                        0 0 1 0 0
                        0 0 0 0.95 0" />
            </filter>
          </defs>

          <!-- aura -->
          <circle cx="350" cy="300" r="260" fill="url(#bgGlow)"/>

          <!-- head -->
          <path d="M350 120
                   C250 120 205 205 205 285
                   C205 365 250 440 350 440
                   C450 440 495 365 495 285
                   C495 205 450 120 350 120Z"
                fill="url(#shell)" stroke="url(#rim)" stroke-width="5" opacity=".98"/>

          <!-- neck + shoulders -->
          <path d="M290 420
                   C300 480 310 520 350 550
                   C390 520 400 480 410 420
                   C450 430 520 480 540 610
                   C480 640 410 660 350 660
                   C290 660 220 640 160 610
                   C180 480 250 430 290 420Z"
                fill="url(#shell)" stroke="rgba(255,255,255,.08)" stroke-width="2"/>

          <!-- collar light -->
          <path d="M310 520
                   C320 560 330 590 350 612
                   C370 590 380 560 390 520"
                fill="none" stroke="rgba(182,107,255,.55)" stroke-width="6" filter="url(#soft)"/>

          <!-- eyes (neon) -->
          <g filter="url(#neon)">
            <path d="M265 290 C295 265 330 265 360 290
                     C330 305 295 305 265 290Z"
                  fill="#58C7FF" opacity=".95"/>
            <path d="M340 290 C370 265 405 265 435 290
                     C405 305 370 305 340 290Z"
                  fill="#58C7FF" opacity=".95"/>
          </g>

          <!-- eyes inner -->
          <path d="M275 290 C300 273 325 273 350 290
                   C325 298 300 298 275 290Z"
                fill="#EFFFFF" opacity=".45"/>
          <path d="M350 290 C375 273 400 273 425 290
                   C400 298 375 298 350 290Z"
                fill="#EFFFFF" opacity=".45"/>

          <!-- face highlights -->
          <path d="M350 155
                   C305 165 275 205 270 245
                   C290 220 315 205 350 198
                   C385 205 410 220 430 245
                   C425 205 395 165 350 155Z"
                fill="rgba(255,255,255,.06)"/>

          <!-- core chip -->
          <rect x="332" y="515" width="36" height="36" rx="8" fill="#58C7FF" opacity=".95" filter="url(#neon)"/>
          <rect x="338" y="521" width="24" height="24" rx="6" fill="#EFFFFF" opacity=".30"/>

          <!-- subtle scan line -->
          <rect x="120" y="290" width="460" height="2" fill="rgba(182,107,255,.25)">
            <animate attributeName="y" values="240;330;240" dur="3.6s" repeatCount="indefinite"/>
            <animate attributeName="opacity" values=".10;.35;.10" dur="3.6s" repeatCount="indefinite"/>
          </rect>

        </svg>
      </div>

      <div class="hint">
        Tip: je≈õli chcesz ‚Äûbardziej surowy STAN‚Äù, to on bƒôdzie dopytywa≈Ç i dociska≈Ç niekonkretno≈õƒá ‚Äî ale bez chamstwa.
      </div>
    </div>

    <div class="card inputCard">
      <textarea id="input" placeholder="Opisz sytuacjƒô. Co siƒô sta≈Ço? Co chcesz osiƒÖgnƒÖƒá? Jakie masz ograniczenia?"></textarea>

      <div class="actions">
        <button class="btn btnPrimary" id="analyzeBtn">Analiza ‚Üí</button>
        <button class="btn btnSmall" id="listenBtn">üéôÔ∏è S≈Çuchaj</button>
        <button class="btn btnSmall" id="speakBtn">üîä Odczytaj</button>
        <button class="btn btnSmall" id="clearBtn">Wyczy≈õƒá</button>
      </div>

      <div class="statusRow">
        <span class="pill">Tryb: DEMO (bez API)</span>
        <span class="pill">Avatar: Semi-human</span>
        <span class="pill" id="voiceSupport">G≈Ços: sprawdzam‚Ä¶</span>
      </div>
    </div>

    <div class="resultGrid">
      <div class="resultCard">
        <div class="resultTitle">Analiza</div>
        <p class="resultText" id="analysis">Tu pojawi siƒô analiza.</p>
      </div>

      <div class="resultCard">
        <div class="resultTitle">Ryzyko</div>
        <p class="resultText" id="risk">Tu pojawi siƒô ocena ryzyka.</p>
      </div>

      <div class="resultCard">
        <div class="resultTitle">Rekomendacja</div>
        <p class="resultText" id="recommendation">Tu pojawi siƒô rekomendacja.</p>
      </div>
    </div>
  </div>

<script>
  // ---------- DEMO "inteligencja" (bez API) ----------
  // STAN: nie jest mi≈Çy. Jest pomocny. Dopytuje. Dociska konkrety. Plan po konkretach lub odmowa.
  function normalize(s){
    return String(s || "").replace(/\s+/g," ").trim();
  }

  function hasAny(text, arr){
    const t = text.toLowerCase();
    return arr.some(k => t.includes(k));
  }

  function stanDemo(text){
    const opening =
`Dobra. Zatrzymajmy chaos na chwilƒô i z≈Çapmy fakty.
Nie bƒôdƒô wr√≥≈ºyƒá. Bƒôdƒô mierzyƒá.`;

    // Za ma≈Ço danych ‚Üí dopytka, bez planu
    if(text.length < 40){
      return {
        analysis: opening + `\n\nMasz za ma≈Ço danych, ≈ºebym da≈Ç plan bez lania wody.`,
        risk: `Ryzyko: zgadywanie + emocje ‚Üí wysokie.`,
        recommendation:
`Dopisz 3 rzeczy (kr√≥tko, konkretnie):
1) Cel: co ma siƒô staƒá po tej decyzji?
2) Ograniczenia: czas / kasa / zdrowie / ryzyko (twarde limity).
3) Opcje: co REALNIE mo≈ºesz zrobiƒá w 48h (A/B/C)?`
      };
    }

    const rel = hasAny(text, ["partner", "zwiƒÖzek", "relacja", "obra≈ºa", "ucieka", "k≈Ç√≥tnia"]);
    const work = hasAny(text, ["praca", "szef", "firma", "projekt", "biznes", "doch√≥d", "pieniƒÖdze"]);
    const emotionHigh = hasAny(text, ["wkur", "wkurwia", "nienawidzƒô", "mam do≈õƒá", "rozbita", "panika", "bojƒô", "boje"]);

    let analysis = opening + "\n\n";
    if(rel) analysis += "Widzƒô konflikt relacyjny i problem komunikacji/bezpiecze≈Ñstwa emocjonalnego.\n";
    if(work) analysis += "Widzƒô wƒÖtek decyzyjny: stabilno≈õƒá vs ryzyko/tempo.\n";
    if(!rel && !work) analysis += "To wyglƒÖda na temat decyzyjny og√≥lny: priorytety ‚Üí konsekwencje ‚Üí plan.\n";

    analysis += "Brakuje mi twardych danych: opcji, ogranicze≈Ñ, stawki.\nNie ko≈Ñczƒô na skr√≥ty ‚Äî dopytam.";

    let risk = "Ryzyko decyzji impulsywnej / b≈Çƒôdnej interpretacji: ";
    risk += emotionHigh ? "wysokie (emocje na froncie)." : "≈õrednie (brak pe≈Çnych danych).";

    // STAN sam proponuje opcje (Twoje ≈ºyczenie)
    let proposed = [];
    if(rel){
      proposed = [
        "A) Rozmowa na faktach (konkretne zachowania ‚Üí konkretne granice ‚Üí konsekwencje).",
        "B) Pauza/odstƒôp 24‚Äì72h i rozmowa dopiero przy spokojnym uk≈Çadzie nerwowym.",
        "C) Je≈õli granice sƒÖ ≈Çamane: plan wyj≈õcia / zabezpieczenie siebie (emocjonalnie i logistycznie)."
      ];
    } else if(work){
      proposed = [
        "A) Bezpieczny tryb: zostajesz w pracy + budujesz projekt 30‚Äì60 min dziennie (metodycznie).",
        "B) Hybryda: negocjujesz mniejsze godziny / freelans, kupujesz czas na projekt.",
        "C) Skok: odcinasz etat dopiero, gdy masz X miesiƒôcy bufora i 1 kana≈Ç sprzeda≈ºy."
      ];
    } else {
      proposed = [
        "A) Zatrzymanie i spis opcji (max 3) + kryteria wyboru.",
        "B) Ma≈Çy eksperyment 7 dni zamiast wielkiej deklaracji.",
        "C) Je≈õli brak danych: najpierw zbierasz dane, potem decyzja."
      ];
    }

    const recommendation =
`Najpierw rozdziel emocjƒô od decyzji.
Twoje opcje (propozycja STANa):
${proposed.map(x=>"‚Ä¢ "+x).join("\n")}

Teraz odpowiedz kr√≥tko:
1) Twoje twarde ograniczenia (czas/kasa/zdrowie) w 1 zdaniu.
2) Kt√≥ra opcja jest realna w 48h (A/B/C)?
Wtedy dam Ci plan na 7 dni i 30 dni ‚Äî bez lania wody.`;

    return { analysis, risk, recommendation };
  }

  // ---------- UI ----------
  const input = document.getElementById("input");
  const analysisEl = document.getElementById("analysis");
  const riskEl = document.getElementById("risk");
  const recEl = document.getElementById("recommendation");

  const analyzeBtn = document.getElementById("analyzeBtn");
  const listenBtn = document.getElementById("listenBtn");
  const speakBtn = document.getElementById("speakBtn");
  const clearBtn = document.getElementById("clearBtn");
  const voiceSupport = document.getElementById("voiceSupport");

  function run(){
    const text = normalize(input.value);
    const out = stanDemo(text);
    analysisEl.textContent = out.analysis;
    riskEl.textContent = out.risk;
    recEl.textContent = out.recommendation;
    speak(out.recommendation);
  }

  analyzeBtn.addEventListener("click", run);
  clearBtn.addEventListener("click", ()=>{
    input.value = "";
    analysisEl.textContent = "Tu pojawi siƒô analiza.";
    riskEl.textContent = "Tu pojawi siƒô ocena ryzyka.";
    recEl.textContent = "Tu pojawi siƒô rekomendacja.";
  });

  // ---------- M√ìWIENIE (TTS) ----------
  function speak(text){
    try{
      if(!("speechSynthesis" in window)) return;
      window.speechSynthesis.cancel();
      const u = new SpeechSynthesisUtterance(String(text || ""));
      u.lang = "pl-PL";
      u.rate = 1.0;
      u.pitch = 1.0;
      window.speechSynthesis.speak(u);
    }catch(e){}
  }

  speakBtn.addEventListener("click", ()=>{
    const all = [analysisEl.textContent, riskEl.textContent, recEl.textContent].join("\n\n");
    speak(all);
  });

  // ---------- S≈ÅUCHANIE (SpeechRecognition je≈õli jest, inaczej dyktowanie iOS) ----------
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  let recognition = null;
  let listening = false;

  function setupRecognition(){
    if(!SpeechRecognition) return false;
    recognition = new SpeechRecognition();
    recognition.lang = "pl-PL";
    recognition.interimResults = true;
    recognition.continuous = false;

    recognition.onresult = (event)=>{
      let finalText = "";
      let interim = "";
      for(const res of event.results){
        if(res.isFinal) finalText += res[0].transcript;
        else interim += res[0].transcript;
      }
      // wpisuj na ≈ºywo
      const base = input.value.replace(/\s+$/,"");
      input.value = (base ? base + " " : "") + (finalText || interim);
    };

    recognition.onend = ()=>{
      listening = false;
      listenBtn.textContent = "üéôÔ∏è S≈Çuchaj";
    };

    recognition.onerror = ()=>{
      listening = false;
      listenBtn.textContent = "üéôÔ∏è S≈Çuchaj";
      alert("S≈Çuchanie g≈Çosowe nie zadzia≈Ça≈Ço tutaj. Na iPhonie u≈ºyj dyktowania z klawiatury (mikrofon przy spacji).");
    };

    return true;
  }

  const canListen = setupRecognition();
  const canSpeak = ("speechSynthesis" in window);
  voiceSupport.textContent = `G≈Ços: ${canSpeak ? "m√≥wi" : "brak TTS"} / ${canListen ? "s≈Çucha" : "s≈Çuchanie: dyktowanie iOS"}`;

  listenBtn.addEventListener("click", ()=>{
    if(canListen && recognition){
      if(listening){
        try{ recognition.stop(); }catch(e){}
        listening = false;
        listenBtn.textContent = "üéôÔ∏è S≈Çuchaj";
        return;
      }
      // iOS/Safari wymaga gestu u≈ºytkownika ‚Äî klik jest OK
      listening = true;
      listenBtn.textContent = "‚èπ Stop";
      try{ recognition.start(); }catch(e){
        listening = false;
        listenBtn.textContent = "üéôÔ∏è S≈Çuchaj";
        alert("Nie mogƒô uruchomiƒá s≈Çuchania. U≈ºyj dyktowania z klawiatury iOS (mikrofon przy spacji).");
      }
    } else {
      // fallback bez API
      input.focus();
      alert("iOS czƒôsto blokuje SpeechRecognition. U≈ºyj dyktowania: przytrzymaj mikrofon na klawiaturze (spacja) i m√≥w ‚Äî STAN to przyjmie jako tekst.");
    }
  });

</script>
</body>
</html>