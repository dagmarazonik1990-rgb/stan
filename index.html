<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>STAN â€“ Agent decyzyjny AI</title>

<style>
body{
  margin:0;
  font-family: system-ui, -apple-system, sans-serif;
  background: linear-gradient(180deg,#07162d,#0d274d);
  color:white;
  padding:20px;
}

h1{
  margin-bottom:4px;
}

.subtitle{
  opacity:.7;
  margin-bottom:20px;
}

textarea{
  width:100%;
  min-height:120px;
  border-radius:14px;
  border:none;
  padding:16px;
  font-size:16px;
  background:#0f2a4d;
  color:white;
  resize:none;
}

button{
  margin-top:16px;
  width:100%;
  padding:14px;
  font-size:16px;
  border-radius:14px;
  border:none;
  background:linear-gradient(90deg,#4f8cff,#2563eb);
  color:white;
  cursor:pointer;
}

.card{
  margin-top:20px;
  background:#0f2a4d;
  padding:16px;
  border-radius:14px;
}

.result-title{
  font-weight:600;
  margin-bottom:8px;
  opacity:.8;
}

.muted{
  opacity:.8;
}
</style>
</head>

<body>

<h1>STAN</h1>
<div class="subtitle">Agent decyzyjny AI</div>

<textarea id="input" placeholder="Opisz sytuacjÄ™. Co siÄ™ staÅ‚o? Co chcesz osiÄ…gnÄ…Ä‡? Jakie masz ograniczenia?"></textarea>

<button onclick="analyze()">Analiza â†’</button>

<div class="card">
  <div class="result-title">Analiza</div>
  <div id="analysis" class="muted">Tu pojawi siÄ™ analiza.</div>
</div>

<div class="card">
  <div class="result-title">Ryzyko</div>
  <div id="risk" class="muted">Tu pojawi siÄ™ ocena ryzyka.</div>
</div>

<div class="card">
  <div class="result-title">Rekomendacja</div>
  <div id="recommendation" class="muted">Tu pojawi siÄ™ rekomendacja.</div>
</div>

<script>
async function analyze(){

  const text = document.getElementById("input").value.trim();

  if(text.length < 20){
    alert("Napisz trochÄ™ wiÄ™cej ðŸ™‚");
    return;
  }

  document.getElementById("analysis").innerText = "AnalizujÄ™...";
  document.getElementById("risk").innerText = "-";
  document.getElementById("recommendation").innerText = "-";

  try{

    const res = await fetch("/api/analyze",{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body: JSON.stringify({ text })
    });

    if(!res.ok){
      throw new Error("Status " + res.status);
    }

    const data = await res.json();

    document.getElementById("analysis").innerText = data.analysis || "Brak analizy.";
    document.getElementById("risk").innerText = data.risk || "-";
    document.getElementById("recommendation").innerText = data.recommendation || "-";

  }catch(err){

    // JeÅ›li API padnie â€” fallback demo STAN
    const demo = generateDemoStan(text);

    document.getElementById("analysis").innerText = demo.analysis;
    document.getElementById("risk").innerText = demo.risk;
    document.getElementById("recommendation").innerText = demo.recommendation;

  }
}

// Demo inteligencja STAN (bez API)
function generateDemoStan(text){

  const emotional = text.includes("bojÄ™") || text.includes("zÅ‚a") || text.includes("wkurz");

  return {
    analysis: emotional
      ? "Opis wskazuje na silne emocje. Decyzja podjÄ™ta teraz moÅ¼e byÄ‡ bardziej reakcjÄ… niÅ¼ strategiÄ…."
      : "Sytuacja wymaga chÅ‚odnej analizy. Kluczowe jest oddzielenie faktÃ³w od interpretacji.",

    risk: emotional
      ? "Ryzyko decyzji impulsywnej: wysokie."
      : "Ryzyko bÅ‚Ä™dnej oceny przy braku danych: Å›rednie.",

    recommendation:
      "Oddziel emocjÄ™ od dziaÅ‚ania. Ustal: 1) czego chcesz, 2) czego nie zaakceptujesz, 3) jaki pierwszy maÅ‚y krok moÅ¼esz wykonaÄ‡ w 7 dni."
  };
}
</script>

</body>
</html>