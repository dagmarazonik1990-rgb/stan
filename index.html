<script>
async function analyze() {
  const inputEl = document.getElementById("input");
  const analysisEl = document.getElementById("analysis");
  const riskEl = document.getElementById("risk");
  const recommendationEl = document.getElementById("recommendation");

  const text = inputEl.value.trim();

  if (text.length < 20) {
    alert("Napisz trochÄ™ wiÄ™cej ðŸ™‚");
    return;
  }

  analysisEl.innerText = "AnalizujÄ™...";
  riskEl.innerText = "â€”";
  recommendationEl.innerText = "â€”";

  try {
    const res = await fetch("/api/analyze", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text })
    });

    if (!res.ok) {
      throw new Error("BÅ‚Ä…d serwera");
    }

    const data = await res.json();

    analysisEl.innerText = data.analysis ?? "Brak analizy.";
    riskEl.innerText = data.risk ?? "Brak oceny ryzyka.";
    recommendationEl.innerText = data.recommendation ?? "Brak rekomendacji.";

  } catch (err) {
    analysisEl.innerText = "Nie mogÄ™ teraz dokoÅ„czyÄ‡ analizy.";
    riskEl.innerText = "Ryzyko: przerwana analiza = bÅ‚Ä™dne wnioski.";
    recommendationEl.innerText = "SprÃ³buj ponownie za chwilÄ™.";
  }
}
</script>